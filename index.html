<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Физика: Wordle + Crossword</title>
    <style>
        html, body {
            height: 100%; margin: 0; background-color: #121213; color: white;
            font-family: 'Segoe UI', Arial, sans-serif; display: flex; flex-direction: column; overflow: hidden;
        }
        
        header { text-align: center; padding: 15px; flex-shrink: 0; position: relative; border-bottom: 1px solid #3a3a3c; }
        
        #energy-container {
            font-size: 1.8rem; font-weight: bold; color: #ffeb3b; margin: 10px 0;
            display: none;
        }

        #dots-container { display: flex; gap: 10px; justify-content: center; min-height: 20px; margin-bottom: 10px; }
        .dot { width: 15px; height: 15px; border-radius: 50%; border: 2px solid #3a3a3c; transition: 0.3s; }
        .dot.active { background-color: #538d4e; border-color: #58a351; }

        #back-btn { 
            position: absolute; left: 20px; top: 20px; display: none;
            background: #3a3a3c; border: none; color: white; padding: 10px 20px;
            border-radius: 10px; cursor: pointer; font-size: 1.1rem; z-index: 10;
        }

        #menu-screen {
            display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;
        }
        .menu-btn {
            width: 300px; max-width: 90%; padding: 20px; margin: 10px; font-size: 1rem;
            border: none; border-radius: 15px; cursor: pointer; color: white; transition: 0.3s; font-weight: bold;
        }
        .easy-btn { background: #538d4e;}
        .medium-btn { background: #b59f3b;}
        .hard-btn { background: #af4d4d;}
        .crossword-btn { background: #2196f3; }
        .menu-btn:hover { transform: scale(1.03); filter: brightness(1.1); }

        #game-screen { display: none; flex-direction: column; align-items: center; flex-grow: 1; overflow-y: auto; width: 100%; padding-top: 20px;}
        
        #board { display: grid; gap: 8px; justify-content: center; margin-bottom: 20px; }
        .cell {
            width: 60px; height: 60px; border: 3px solid #3a3a3c;
            display: flex; justify-content: center; align-items: center;
            font-size: 2rem; font-weight: bold; text-transform: uppercase;
        }
        .correct { background-color: #538d4e !important; border-color: #538d4e !important; }
        .present { background-color: #b59f3b !important; border-color: #b59f3b !important; }
        .absent { background-color: #3a3a3c !important; border-color: #3a3a3c !important; }
        .flip { animation: flip-cell 0.6s ease forwards; }
        @keyframes flip-cell { 50% { transform: rotateX(90deg); } }

        #crossword-container { display: none; flex-direction: row; width: 95%; max-width: 1200px; gap: 20px; margin-top: 10px; }
        #crossword-clues { width: 35%; padding: 25px; background: #1e1e1f; border-radius: 15px; border: 3px solid #538d4e; overflow-y: auto; max-height: 70vh; }
        #crossword-grid-wrapper { width: 65%; display: flex; justify-content: center; align-items: center; background: #181819; border-radius: 15px; padding: 20px; }
        #crossword-grid { display: grid; gap: 8px; }
        
        .cw-cell { position: relative; width: 60px; height: 60px; }
        .cw-input {
            width: 100%; height: 100%; background: #1e1e1f; border: 2px solid #538d4e; 
            border-radius: 8px; color: white; text-align: center; font-size: 1.8rem; 
            text-transform: uppercase; font-weight: bold; outline: none;
        }
        .cw-num { 
            position: absolute; top: -5px; left: -5px; font-size: 0.9rem; 
            color: white; background: #538d4e; width: 20px; height: 20px;
            display: flex; align-items: center; justify-content: center; border-radius: 50%; z-index: 5;
        }
        .cw-input.correct-anim { background: #538d4e; border-color: white; }
        .cw-input.wrong { background: #af4d4d; animation: shake 0.4s; }

        #modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 100;
        }
        #modal { background: #1e1e1f; padding: 40px; border-radius: 25px; text-align: center; border: 4px solid #538d4e; max-width: 500px; }
        #modal h2 { font-size: 2.5rem; margin-top: 0; color: #538d4e; }
        #modal p { font-size: 1.3rem; line-height: 1.5; }
        
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
    </style>
</head>
<body>

    <header>
        <button id="back-btn" onclick="location.reload()">НАЗАД</button>
        <h1 id="main-title" style="margin:0; font-size: 2rem;">ФИЗИКА QUIZ</h1>
        <div id="energy-container">ЭНЕРГИЯ: <span id="energy-val">100</span> B</div>
        <div id="dots-container"></div>
    </header>

    <div id="menu-screen">
        <button class="menu-btn easy-btn" onclick="startGame('easy')">ОҢАЙ (Wordle)</button>
        <button class="menu-btn medium-btn" onclick="startGame('medium')">ОРТАША (Wordle)</button>
        <button class="menu-btn hard-btn" onclick="startGame('hard')">ҚИЫН (Wordle)</button>
        <button class="menu-btn crossword-btn" onclick="startGame('crossword')">КРОССВОРД</button>
    </div>

    <div id="game-screen">
        <div id="board"></div>
        
        <div id="crossword-container">
            <div id="crossword-clues">
                <h2 style="color:#538d4e; margin-top:0">ФИЗИКАҒА ҚАТЫСТЫ СӨЗДЕР</h2>
                <p><strong>1.</strong> Оң зарядталған электрод (4 әріп)</p>
                <p><strong>2.</strong> Атомның орталығы (4 әріп)</p>
                <p><strong>3.</strong> Жарықты зерттейтін бөлім (3 әріп)</p>
                <p><strong>4.</strong> Гамма-сәулелердің экспозициялық дозасының жүйеден тыс өлшем бірлігі (7 әріп)</p>
                <p><strong>5.</strong> Кванттық жарық көзі (5 әріп)</p>
                <h2 style="color:#538d4e; margin-top:0">БРАВЛҒА ҚАТЫСТЫ СӨЗДЕР</h2>
                <p><strong>6.</strong> Песчанная буря (5 әріп)</p>
                <p><strong>7.</strong> Бумеранг (4 әріп)</p>

                <button class="menu-btn easy-btn" style="width:100%; margin:20px 0 0 0" onclick="checkCrossword()">ТЕКСЕРУ</button>
            </div>
            <div id="crossword-grid-wrapper">
                <div id="crossword-grid"></div>
            </div>
        </div>
    </div>

    <div id="modal-overlay">
        <div id="modal">
            <h2 id="modal-title"></h2>
            <p id="modal-desc"></p>
            <button class="menu-btn easy-btn" style="width:auto; padding: 10px 40px" onclick="nextAction()">КЕЛЕСІ</button>
        </div>
    </div>

    <script>
        const wordData = {
            easy: ['ЯДРО', 'ЛАЗЕР', 'ФОТОН'],
            medium: ['КЕРНЕУ', 'ТОМСОН', 'ОПТИКА'],
            hard: ['РЕЗЕРФОРД', 'РАДИАЦИЯ']
        };

        const descriptions = {
            'ЯДРО': 'Атомның орталық бөлігі. Онда барлық оң заряд пен масса шоғырланған.',
            'ЛАЗЕР': 'Оптикалық кванттық генератор. Жіңішке, бағытталған жарық сәулесі.',
            'ФОТОН': 'Жарықтың ең кіші бөлінбейтін бөлшегі немесе кванты.',
            'КЕРНЕУ': 'Электр өрісінің жұмысын сипаттайтын физикалық шама.',
            'ТОМСОН': 'Электронды ашқан және атомның алғашқы моделін ұсынған физик.',
            'ОПТИКА': 'Физиканың жарық құбылыстарын зерттейтін бөлімі.',
            'РЕЗЕРФОРД': 'Атомның планетарлық моделін жасаған ғалым.',
            'РАДИАЦИЯ': 'Энергияның толқын не бөлшек түрінде таралуы.'
        };

        const crosswordMap = [
        {y:1,x:3,c:'А',n:1},{y:2,x:3,c:'Н'},{y:4,x:3,c:'Д'},
        {y:3,x:0,c:'Я',n:2},{y:3,x:1,c:'Д'},{y:3,x:2,c:'Р'},
        {y:3,x:3,c:'О',n:3},{y:3,x:4,c:'П'},{y:3,x:5,c:'Т'},{y:3,x:6,c:'И'},{y:3,x:7,c:'К'},{y:3,x:8,c:'А'},{y:2,x:8,c:"К",n:7},{y:4,x:8,c:"Р"},{y:5,x:8,c:"Л"},
        {y:1,x:2,c:'Л',n:5},{y:1,x:4,c:'З'},{y:1,x:5,c:'Е'},{y:1,x:6,c:'Р'},{y:0,x:5,c:'Р',n:4},{y:2,x:5,c:'Н'},{y:4,x:5,c:'Г'},{y:5,x:5,c:'Е'},{y:6,x:5,c:'Н'},{y:6,x:3,c:"С",n:6},{y:6,x:4,c:"Э"},{y:6,x:6,c:"Д"},{y:6,x:7,c:"И"}
        ];

        let currentMode = '';
        let targetWord = '';
        let level = 0;
        let row = 0;
        let col = 0;
        let energy = 100;
        let gameOver = false;

        function startGame(mode) {
            currentMode = mode;
            document.getElementById('menu-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'flex';
            document.getElementById('back-btn').style.display = 'block';
            document.getElementById('energy-container').style.display = 'block';
            
            if (mode === 'crossword') {
                initCrossword();
            } else {
                level = 0;
                createDots();
                initWordle();
            }
        }

        function createDots() {
            const container = document.getElementById('dots-container');
            container.innerHTML = '';
            wordData[currentMode].forEach((_, i) => {
                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.id = `dot-${i}`;
                container.appendChild(dot);
            });
        }

        function initWordle() {
            const words = wordData[currentMode];
            targetWord = words[level];
            const board = document.getElementById('board');
            board.innerHTML = '';
            board.style.gridTemplateColumns = `repeat(${targetWord.length}, 60px)`;
            document.getElementById('crossword-container').style.display = 'none';
            board.style.display = 'grid';

            for (let i = 0; i < 6; i++) {
                for (let j = 0; j < targetWord.length; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.id = `cell-${i}-${j}`;
                    board.appendChild(cell);
                }
            }
            
            document.querySelectorAll('.dot').forEach((d, i) => d.classList.toggle('active', i === level));
            row = 0; col = 0; gameOver = false;
        }

        window.addEventListener('keydown', (e) => {
            if (gameOver || currentMode === 'crossword' || document.getElementById('game-screen').style.display === 'none') return;
            
            if (e.key === 'Enter') {
                if (col === targetWord.length) checkWord();
            } else if (e.key === 'Backspace') {
                if (col > 0) {
                    col--;
                    document.getElementById(`cell-${row}-${col}`).textContent = '';
                }
            } else if (/^[а-яА-ЯөӨәӘіІңҢғҒүҮұҰқҚһҺёЁ]$/i.test(e.key) && col < targetWord.length) {
                document.getElementById(`cell-${row}-${col}`).textContent = e.key.toUpperCase();
                col++;
            }
        });

        async function checkWord() {
            let guess = '';
            for (let i = 0; i < targetWord.length; i++) guess += document.getElementById(`cell-${row}-${i}`).textContent;

            const targetArr = targetWord.split('');
            const status = Array(targetWord.length).fill('absent');

            for (let i = 0; i < targetWord.length; i++) {
                if (guess[i] === targetWord[i]) {
                    status[i] = 'correct';
                    targetArr[i] = null;
                }
            }

            for (let i = 0; i < targetWord.length; i++) {
                if (status[i] !== 'correct' && targetArr.includes(guess[i])) {
                    status[i] = 'present';
                    targetArr[targetArr.indexOf(guess[i])] = null;
                }
            }

            gameOver = true; 
            for (let i = 0; i < targetWord.length; i++) {
                const cell = document.getElementById(`cell-${row}-${i}`);
                cell.classList.add('flip');
                setTimeout(() => cell.classList.add(status[i]), 300);
                await new Promise(r => setTimeout(r, 100));
            }

            if (guess === targetWord) {
                setTimeout(() => showModal("ДУРЫС!", descriptions[targetWord]), 500);
            } else if (row === 5) {
                energy -= 20;
                updateEnergy();
                setTimeout(() => showModal("ИГРА ЗАКОНЧЕНА", `Правильный ответ: ${targetWord}`), 500);
            } else {
                row++; col = 0; gameOver = false;
            }
        }

        function initCrossword() {
            const grid = document.getElementById('crossword-grid');
            grid.innerHTML = '';
            grid.style.gridTemplateColumns = `repeat(11, 60px)`;
            document.getElementById('board').style.display = 'none';
            document.getElementById('crossword-container').style.display = 'flex';
            document.getElementById('dots-container').innerHTML = '';

            for (let r = 0; r < 8; r++) {
                for (let c = 0; c < 11; c++) {
                    const data = crosswordMap.find(m => m.y === r && m.x === c);
                    const cell = document.createElement('div');
                    cell.className = 'cw-cell';
                    if (data) {
                        const num = data.n ? `<span class="cw-num">${data.n}</span>` : '';
                        cell.innerHTML = `${num}<input class="cw-input" maxlength="1" data-c="${data.c}">`;
                    }
                    grid.appendChild(cell);
                }
            }
        }

        function checkCrossword() {
            let win = true;
            document.querySelectorAll('.cw-input').forEach(i => {
                if(i.value.toUpperCase() === i.dataset.c) {
                    i.classList.add('correct-anim');
                    i.classList.remove('wrong');
                } else {
                    i.classList.add('wrong');
                    win = false;
                    setTimeout(() => i.classList.remove('wrong'), 500);
                }
            });
            if(win) showModal("ПОБЕДА!", "Кроссворд решен!");
            else {
                energy -= 10;
                updateEnergy();
            }
        }

        function updateEnergy() {
            document.getElementById('energy-val').innerText = energy;
            if (energy <= 0) {
                showModal("ЭНЕРГИЯ ЗАКОНЧИЛАСЬ", "Игра закончена");
                setTimeout(() => location.reload(), 2000);
            }
        }

        function showModal(title, desc) {
            document.getElementById('modal-overlay').style.display = 'flex';
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-desc').innerText = desc;
        }

        function nextAction() {
            document.getElementById('modal-overlay').style.display = 'none';
            if (currentMode === 'crossword') {
                location.reload();
            } else {
                level++;
                if (level < wordData[currentMode].length) {
                    initWordle();
                } else {
                    showModal("ВСЕ!", "Все уровни пройдены!");
                    setTimeout(() => location.reload(), 2000);
                }
            }
        }
    </script>
</body>
</html>
